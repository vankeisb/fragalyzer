(this.webpackJsonpfragalyzer=this.webpackJsonpfragalyzer||[]).push([[0],{31:function(e,n,t){"use strict";(function(e){t.d(n,"e",(function(){return c})),t.d(n,"a",(function(){return o})),t.d(n,"d",(function(){return i})),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return u}));var r=t(37),a=t(645);function c(n){return new Promise((function(t,c){n.arrayBuffer().then((function(n){var o,i=e.from(n),s=new a.DemoFile,u=0,l=(new Date).getTime(),d=new Map,f=!1;s.on("tickend",(function(e){if(u++,f){var n=s.entities.players;n&&n.length>0&&n.forEach((function(n){if(n&&!n.isFakePlayer&&n.isAlive){var t=Object(r.pos)(n.position.x,n.position.y),a=d.get(n.name);void 0===a&&(a=[],d.set(n.name,a));var c={p:t,tick:e};a.push(c)}}))}}));var m=[],p=0;s.gameEvents.on("begin_new_match",(function(e){if(console.log("begin match"),void 0===o){f=!0,o=[];var n=s.players;o=n.filter((function(e){return!e.isFakePlayer&&e.teamNumber>=2})).map((function(e){var n=e.team;return{name:e.name,clanName:(null===n||void 0===n?void 0:n.clanName)||e.teamNumber.toString()}})),console.log("players",o)}}));var j=0;s.gameEvents.on("round_start",(function(){console.log("round start"),j=s.currentTick})),s.gameEvents.on("round_end",(function(e){console.log("round end",e.winner),p=e.winner})),s.gameEvents.on("round_officially_ended",(function(e){console.log("round officially ended");var n=s.teams,t=n[2],r=n[3];console.log("\t%s: %s score %d\n\t%s: %s score %d",t.teamName,t.clanName,t.score,r.teamName,r.clanName,r.score),m.push({startTick:j,endTick:s.currentTick,winner:p,scoreCT:r.score,clanCT:r.clanName,scoreT:t.score,clanT:t.clanName})})),s.gameEvents.on("round_start",(function(e){p=0,console.log("round start",s.gameRules.roundsPlayed)})),s.on("end",(function(e){if(console.log("done, ticks =",u,"elapsed =",(new Date).getTime()-l),console.log("Finished."),e.error)console.error("Error during parsing:",e.error),c(e);else{var n={positions:d,players:o,rounds:m,tickRate:s.tickRate};console.log("parsed",n),t(n)}})),s.parse(i)}))}))}function o(e,n,t){var r=new Map;return e.forEach((function(e,a){n.has(a)&&r.set(a,e.filter((function(e){return void 0!==t.find((function(n){return e.tick>=n[0]&&e.tick<=n[1]}))})))})),r}function i(e){var n=new Set;return e.players.forEach((function(e){n.add(e.clanName)})),Array.from(n).sort()}function s(e,n){var t=new Array;return e.players.forEach((function(e){e.clanName===n&&t.push(e)})),t.sort((function(e,n){return e.name.localeCompare(n.name)}))}function u(e){return e.players.map((function(e){return e.name})).sort()}}).call(this,t(71).Buffer)},650:function(e,n,t){},651:function(e,n,t){},764:function(e,n,t){"use strict";t.r(n);var r=t(65),a=t.n(r),c=t(644),o=t.n(c),i=(t(650),t(132)),s=t(13),u=(t(651),t(9)),l=t(94),d=t(37),f=t(133),m=t(51),p=t(31);function j(e,n,t,r){return(t+-e)/((n-e)/r)}var v=[[0,140,255],[255,140,255],[255,0,255],[255,0,0],[255,132,97],[0,183,32],[238,183,32],[10,183,164],[198,197,0],[42,197,255],[221,91,90]],g=[0,0,0];function b(e,n){var t=e.indexOf(n);if(-1===t)return g;var r=v[t];return null!==r&&void 0!==r?r:g}function h(e,n){return"rgba(".concat(e[0],",").concat(e[1],",").concat(e[2],",").concat(n,")")}function O(e,n,t,r){var a=e.getContext("2d");if(!a)throw new Error("no context");a.clearRect(0,0,e.width,e.height);var c,o=n.positions,i=Object(p.b)(n),s=e.getBoundingClientRect(),u=Math.min(s.height,s.width),l=function(e,n){var t,r=0,a=0,c=0,o=0,i=Object(m.a)(n.entries());try{for(i.s();!(t=i.n()).done;){var s,u=t.value,l=Object(m.a)(u[1]);try{for(l.s();!(s=l.n()).done;){var p=s.value;r=Math.min(p.p.x,r),a=Math.max(p.p.x,a),c=Math.min(p.p.y,c),o=Math.max(p.p.y,o)}}catch(w){l.e(w)}finally{l.f()}}}catch(w){i.e(w)}finally{i.f()}var v,g=new Map,b=Object(m.a)(n.entries());try{for(b.s();!(v=b.n()).done;){var h=Object(f.a)(v.value,2),O=h[0],y=h[1];g.set(O,y.map((function(n){return{p:Object(d.pos)(j(r,a,n.p.x,e),j(c,o,n.p.y,e)),tick:n.tick}})))}}catch(w){b.e(w)}finally{b.f()}return g}(u,o),v=n.rounds.filter((function(e,n){return r.has(n)})).map((function(e){return[e.startTick,e.endTick]})),g=.1*n.tickRate/64,O=Object(m.a)(Object(p.a)(l,t,v).entries());try{for(O.s();!(c=O.n()).done;){var y=Object(f.a)(c.value,2),w=y[0],x=y[1];a.fillStyle=h(b(i,w),g);var k,T=Object(m.a)(x);try{for(T.s();!(k=T.n()).done;){var N=k.value;a.fillRect(N.p.x,u-N.p.y,2,2)}}catch(C){T.e(C)}finally{T.f()}}}catch(C){O.e(C)}finally{O.f()}}var y=t(10),w={tag:"window-resized"};function x(e){return{tag:"got-canvas-dimensions",r:e}}function k(){return Object(u.noCmd)({state:{tag:"fresh"},error:u.nothing})}var T="csgo-canvas",N="canvas-wrapper",C=u.Task.fromLambda((function(){var e=document.getElementById(N);if(!e)throw new Error("canvas wrapper not found");var n=e.getBoundingClientRect();return Object(d.dim)(n.width,n.height)}));function E(e,n){return n.error.map((function(e){return Object(y.jsxs)("div",{className:"fragalyzer error",children:[Object(y.jsx)("h1",{children:"Oooops"}),Object(y.jsx)("pre",{children:e.message})]})})).withDefaultSupply((function(){var t=n.state;switch(t.tag){case"fresh":return Object(y.jsx)("div",{className:"fragalyzer home",onDragOver:function(e){e.preventDefault()},onDropCapture:function(n){n.preventDefault();var t={tag:"file-dropped",file:u.nothing};if(1===n.dataTransfer.files.length){var r=n.dataTransfer.files.item(0);e(r?Object(s.a)(Object(s.a)({},t),{},{file:Object(u.just)(r)}):t)}else e(t)},children:"Drop a demo here !"});case"parsing":return Object(y.jsx)("div",{className:"fragalyzer parsing",children:Object(y.jsx)("p",{children:"Parsing, plz wait..."})});case"ready":var r=t.parseResult,a=t.canvasDimensions;return Object(y.jsxs)("div",{className:"fragalyzer ready",children:[Object(y.jsxs)("div",{className:"main",children:[Object(y.jsx)("div",{id:N,className:"map-view",children:Object(y.jsx)("canvas",{height:a.h,width:a.w,id:T})}),Object(y.jsx)("div",{className:"right-panel",children:Object(p.d)(r).map((function(n){var a=Object(p.c)(r,n).map((function(e){return e.name})),c=Object(p.b)(r);return Object(y.jsxs)("div",{className:"team",children:[Object(y.jsx)("h2",{className:"team",children:n}),Object(y.jsx)("ul",{children:a.map((function(n){return Object(y.jsxs)("li",{children:[Object(y.jsx)("div",{className:"player-color",style:{backgroundColor:h(b(c,n),1)}}),Object(y.jsx)("input",{type:"checkbox",name:n,checked:t.selectedPlayers.has(n),onChange:function(t){return e({tag:"toggle-player",player:n})}}),n]},n)}))})]},n)}))})]}),B(e,r,t.selectedRounds)]})}}))}function D(e,n){switch(e.tag){case"window-resized":return"ready"===n.state.tag?[n,u.Task.attempt(C,x)]:Object(u.noCmd)(n);case"got-canvas-dimensions":return e.r.match((function(e){return R(n,(function(t){var r=Object(s.a)(Object(s.a)({},n),{},{state:Object(s.a)(Object(s.a)({},t),{},{canvasDimensions:e})});return[r,z(r)]}))}),(function(e){return Object(u.noCmd)(Object(s.a)(Object(s.a)({},n),{},{error:Object(u.just)(e)}))}));case"file-dropped":return e.file.map((function(e){var t=Object(s.a)(Object(s.a)({},n),{},{state:{tag:"parsing"}}),r=u.Task.fromPromise((function(){return Object(p.e)(e)}));return[t,u.Task.attempt(r,(function(e){return{tag:"got-parse-result",r:e}}))]})).withDefaultSupply((function(){return Object(u.noCmd)(Object(s.a)(Object(s.a)({},n),{},{state:{tag:"fresh"}}))}));case"got-parse-result":return e.r.match((function(e){var t=new Set(e.players.map((function(e){return e.name})));return[Object(s.a)(Object(s.a)({},n),{},{state:{tag:"ready",parseResult:e,selectedPlayers:t,canvasDimensions:d.Dim.zero,selectedRounds:new Set(e.rounds.map((function(e,n){return n})))}}),u.Task.attempt(C,x)]}),(function(e){return Object(u.noCmd)(Object(s.a)(Object(s.a)({},n),{},{error:Object(u.just)(e)}))}));case"got-draw-result":return console.log("draw res"),Object(u.noCmd)(n);case"toggle-player":return R(n,(function(t){var r=t.selectedPlayers,a=r.has(e.player)?Array.from(r).filter((function(n){return n!==e.player})):[].concat(Object(i.a)(Array.from(r)),[e.player]),c=P(n,Object(s.a)(Object(s.a)({},t),{},{selectedPlayers:new Set(a)}));return[c,z(c)]}));case"toggle-round":return R(n,(function(t){var r=t.selectedRounds,a=Array.from(r),c=new Set(r.has(e.index)?a.filter((function(n){return n!==e.index})):[].concat(Object(i.a)(a),[e.index])),o=P(n,Object(s.a)(Object(s.a)({},t),{},{selectedRounds:c}));return[o,z(o)]}))}}function R(e,n){return"ready"===e.state.tag?n(e.state):Object(u.noCmd)(e)}function P(e,n){return Object(s.a)(Object(s.a)({},e),{},{state:n})}function z(e){if("ready"===e.state.tag){var n=e.state,t=n.selectedPlayers;return function(e,n,t){var r=u.Task.fromLambda((function(){var r=document.getElementById(T);if(!r)throw new Error("canvas not found !");return O(r,e,n,t),e}));return u.Task.attempt(r,(function(e){return{tag:"got-draw-result",r:e}}))}(n.parseResult,t,n.selectedRounds)}return u.Cmd.none()}var S=new l.WindowEvents;function M(e){return S.on("resize",(function(){return w}))}function B(e,n,t){return Object(y.jsx)("div",{className:"timeline",children:n.rounds.map((function(n,r){var a=t.has(r),c="round".concat(a?" selected":"");return Object(y.jsx)("div",{className:c,onClick:function(){return e({tag:"toggle-round",index:r})},children:r},r)}))})}var F=function(){return Object(y.jsx)(l.Program,{init:k,view:E,update:D,subscriptions:M,devTools:l.DevTools.init(window)})},_=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,765)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(F,{})}),document.getElementById("root")),_()}},[[764,1,2]]]);
//# sourceMappingURL=main.208ae38e.chunk.js.map